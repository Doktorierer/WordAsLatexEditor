# Word as native Latex editor

Use MS Word as a LaTeX editor, with a preview of LaTeX environments. After automatically hiding the LaTeX-markup, Let the .doc with the generated previews be revised by co-authors and supervisors, who have no time to learn LaTeX. The revised .doc (which is in fact still a LaTeX-file) can be edited further in Word, or copied back to your favourite LaTeX editor (just Ctrl-A, Ctrl-C).

## Problem solved

* Some people want to write papers with LaTeX, but supervisors and co-authors may better revise in Word for various reasons. For example, some features of Word are good: Track change, commenting (better than `Overleaf` we have to admit), concurrent editing, comparing and merging files, spell/grammar/style check, section folding, etc.
* Converting a latex-generated .pdf to .doc is simple with good results: Open the .pdf in Word. The problem is the back-conversion of .doc to .tex. Though `pandoc` can handle conversion partially, you may still have to manually insert changes from the revised .doc back to your .tex file. Hence, we stay totally in LaTeX, without any conversion.


## Files/Installation

* **Word template with macros:** `LatexEditor.dotm`. Put this template in `C:\Users\<name>\AppData\Roaming\Microsoft\Word\STARTUP`. The template has also a small example Latex code; the pdf-version is `LatexEditor.pdf` (generated by clicking `Run LaTeX` on the new `LaTeX` Ribbon-Tab)
*  **Preamble for previewing LaTeX environments:** `template.tex`. Put this .tex in the same directory as your working document. If you use special packages in LaTeX tables, figures, math environments, then add in this .tex the lines `\usepackage{...}`.
* **`LaTeX`-ribbon-tab definition:** `Word Customizations.exportedUI`. In Word, import this file in to the ribbon: Right-Click on ribbon -> `Customize the Ribbon...`. This is the most simple way to install. However, simple importing overwrites other custom ribbons. However, most users have no custom ribbons (ACROBAT and other third-party ribbons seems to get well preserved)
* **`VBACode.txt`:** The VBA-Macro code copied out from `LatexEditor.dotm`. This allows to circumvent certain anti-virus software problems when you try to store the VBA-Macros sometimes together with the Word-file.

![LaTeXribbon](https://user-images.githubusercontent.com/113771815/192064971-68e64966-ec35-418c-a8e7-f0a8dcb03c0c.PNG)

## Features

The VBA-code let you (all functionality through buttons on a new `LaTeX` tab in the Word ribbon):

* Preview LaTeX-environments: `equation`, `align`, `table`, `figure`, etc.
* Format some common Latex-markup to gray or white, and `label`, `(eq)ref`, `cite(tp)` to blue
* Format LaTeX-section markups into Word headings. With this, folding of code parts is possible
* Hide LaTeX-markup (using the hidden text feature of Word)
* Run pdfLaTeX for the whole Word document and display the resulting .pdf


### Prerequisites

* LaTeX installation (with the usual `latemk` command)
 * Installed LaTeX packages: `standalone`, `preview`, `amsmath`, `amssymb`
* `ghostscript` installation. The macro-code ask you to browse manually, or else it searches the usual 32-bit or 64-bit progam folders on the c-drive (i.e. `gswin32c.exe` or `gswin64c.exe`). Indeed, `ghostscript` is usually already installed by the common Latex distributions `TeXLive` or `MikTeX`, and you may browse to those. Info: Ghostcript is  used as the .pdf -> .png converter: gswin32 is the older 32-bit version.
* Tick the required References in the VBA-editor of Word (`ALT-F11` -> `References`):
  * VBA Scripting Runtime (or similar named)
  * VBA Regex (or similar named)
  
  Else the code gives errors: Object not found, etc.
* Trust Center of Word: Add location of file to the Trusted Location. Best is also to allow all macros in all variations.

## Example workflow

* After you drafted your .tex in your preferred LaTeX-editor, open the .tex in Word (MS-DOS import setting works well; you can change the filename, font etc.), or you draft your LaTeX directly in Word
* For a nice viewing:
     * Set paragraph spacing to zero
	 * Align pargraphs to block
	 * LateX-comments must be written with two %% to be seen to be formatted
* Run the VBA-macro (accessible through the new Latex-Ribbon) to preview: tables, equation, figure, align etc.
* Prepare the file to your MS Word affine co-authors:  Convert the previews into inline pictures, and hide the markup completely

### Bibliography
There is no preview of bibliography. This can be done in 20 seconds manually. Run the runLaTeX-macro, or use your preferred Latex-editor to produce a .pdf of your work (which has the reference section), then view the .pdf with word, and paste the reference section at the end.


## Caveat
If saving the .dotm is not possible because of anti-virus software: Use the `LateXEditor.dotm` directly as the word-document; rename it to a .doc or .docm file. The **(Un)comment some lines of VBA-Code**: If in the VBA-editor (ALT-F11)  the lines directly under the text `COMMENT FOLLOWING LINE` are (un)commented, comment/uncomment them; they call shells. Such code may be flagged by anti-virus software as suspicious, especially during saving. So, if you save the .doc, and the anti-virus goes havoc, comment the code.




## Limitations/Bugs

* Tested on MS Windows 10 and Word 2016.
* Currently, you can preview and delete all generated pictures at once only
* Not all markup gets recognized, and labels, refs, and cites get not deleted
* Equation numbering is basic (align is not yet recognized with multiple numbers)
* The snippets when converted to inline-shapes do not wrap properly on a line on their own 
* Only ASCII character files work surely. The conversion is not fully UTF compatible.






