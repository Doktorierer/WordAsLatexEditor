# Word as native Latex editor

Use MS Word as a LaTeX editor with a preview of LaTeX environments. Let the .doc with the generated previews be revised by co-authors and supervisors, who have no time to learn LaTeX. The revised .doc can edited further in MS Word, or copied back to your favourite LaTeX editor (just Ctrl-A, Ctrl-C).


## Files

* `LatexEditor.doc`: Example LaTeX document in Word with VBA-Macros (the pdf-version is `LatexEditor.pdf` (generated by clicking `Run LaTeX` on the new `LaTeX` Ribbon-Tab))
* `template.tex`: The premable for the preview of LaTeX environments
* `Word Customizations.exportedUI`: Import this file in Word in Ribbon->Customize in case the `LaTeX`-ribbon-tab has vanished for any reason, or is incomplete


## Problem addressed

* Some people want to write papers with Latex, but supervisors and co-authors may better revise in Word for various reasons. For example, some features of Word are good: Track change, commenting (better than `Overleaf` we have to admit), concurrent editing, comparing and merging files, spell/grammar/style check, section folding, etc.
* Converting a latex-generated .pdf to .doc is simple with good results: Open the .pdf in Word. The problem is the back-conversion of .doc to .tex. Though `pandoc` can handle conversion partially, you may still have to manually insert changes from the revised .doc back to your .tex file. Hence, we stay totally in Latex, without any conversion.


## Features

The VBA-code let you:

* Access all functionality through buttons on a new `LaTeX` tab in the Word ribbon
* Preview LaTeX environments: `equation`, `align`, `table`, `figure`, etc.
* Format some common Latex-markup to gray or white
* Format Latex-section-markup into Word headings. Then you can e.g. fold them in Word.
* Hide Latex-markup (using the hidden text feature of Word)
* Run pdfLaTeX from Word and display the resulting .pdf

## Installation

* No specific installation required: The VBA-Code is inside `LatexEditor.doc`
* **Uncomment some lines of VBA-Code**: If in the VBA-editor (ALT-F11)  the lines directly under the text `COMMENT FOLLOWING LINE` are commented, uncomment them; they call shells. Such code may be flagged by anti-virus software as suspicious, especially during saving. So, if you save the .doc, and the anti-virus goes havoc, comment the code.


### Prerequisites

* LaTeX (with the usual `latemk` command)
* LaTeX packages: `standalone`, `preview`, `amsmath`, `amssymb`
* A standard installation of `gswin32c.exe` or `gswin64c.exe`, that is, `ghostcript`, must be installed in the usual progam folder on the c-drive. Info: Ghostcript is  used as the .pdf -> .png converter: gswin32 is the older 32-bit version.
* Required References in the VBA-editor are ticked (ALT-F11 -> References):
  * VBA Scripting Runtime (or similar named)
  * VBA Regex (or similar named)
  
  Else the code gives errors: Object not found, etc.
* Trust Center of Word: Add location of file to the Trusted Location. Best is also to allow all macros in all variations.

## How to use

* After you drafted your .tex in your preferred Latex-editor, paste it into `LatexEditor.doc` (you can change the name), or you draft your .txt directly in Word
* For a nice viewing, set paragraph spacing to zero
* Run the VBA-macro (accessible through the new Latex-Ribbon) to preview: tables, equation, figure, align etc.
* Prepare the file to your MS Word affine co-authors:  Convert the previews into inline pictures, and hide the markup completely

## Caveats
* Adjust the path to the example image test.jpg such that latex can find it
* With RunLatex, it seems that .tex and .pdf are put into the personal folder, and not in the .doc folder. At the moment, the code tries to copy the two files back


### Bibliography
There is no preview of bibliography. This can be done in 20 seconds manually. Run the runLaTeX-macro, or use your preferred Latex-editor to produce a .pdf of your work (which has the reference section), then view the .pdf with word, and paste the reference section at the end.


## Limitations/Bugs

* Tested on MS Windows 10 and Word 2016.
* Currently, you can preview and delete all generated pictures at once only
* Extend the recognized Latex markups, i.e., better the wildcard matches
* The snippets when converted to inline-shapes do not wrap properly on a line on their own 
* Only ASCII character files work surely. The conversion is not fully UTF compatible.






